# دليل إعداد قاعدة البيانات - MongoDB Atlas

## المشكلة الحالية
لا يمكن الاتصال بقاعدة البيانات لأن عنوان IP الخاص بك غير موجود في قائمة المسموح بها في MongoDB Atlas.

## الحل السريع (5 دقائق)

### الخطوة 1: تسجيل الدخول إلى MongoDB Atlas
1. اذهب إلى: https://cloud.mongodb.com/
2. سجل الدخول بحسابك

### الخطوة 2: إضافة عنوان IP
1. من القائمة الجانبية، اختر **"Network Access"** (أو **"IP Access List"**)
2. اضغط على زر **"Add IP Address"** (أو **"ADD IP ADDRESS"**)
3. ستظهر نافذة منبثقة، اختر أحد الخيارات:
   
   **الخيار الأول (موصى به):**
   - اضغط على **"Add Current IP Address"**
   - سيتم إضافة IP الحالي تلقائياً
   - اضغط **"Confirm"**
   
   **الخيار الثاني (للتطوير فقط):**
   - اضغط على **"Allow Access from Anywhere"**
   - أو أدخل يدوياً: `0.0.0.0/0`
   - ⚠️ **تحذير:** هذا يسمح بالوصول من أي مكان - استخدم فقط للتطوير!
   - اضغط **"Confirm"**

### الخطوة 3: انتظر قليلاً
- قد يستغرق الأمر من 1-2 دقيقة حتى يتم تفعيل الإعدادات

### الخطوة 4: أعد تشغيل السيرفر
```bash
# في مجلد backend
npm run dev
```

## التحقق من الاتصال
إذا تم كل شيء بشكل صحيح، سترى:
```
✅ تم الاتصال بقاعدة البيانات بنجاح!
Server is running at http://localhost:5000
```

## مشاكل أخرى محتملة

### 1. خطأ في المصادقة (Authentication)
**الخطأ:** `Authentication failed`

**الحل:**
- تأكد من صحة اسم المستخدم وكلمة المرور في ملف `.env`
- إذا كانت كلمة المرور تحتوي على رموز خاصة (@, #, %, &)، يجب ترميزها:
  - `@` → `%40`
  - `#` → `%23`
  - `%` → `%25`
  - `&` → `%26`

### 2. خطأ في سلسلة الاتصال (Connection String)
**التنسيق الصحيح:**
```env
MONGO_URI=mongodb+srv://username:password@cluster-name.mongodb.net/database-name?retryWrites=true&w=majority
```

**مثال:**
```env
MONGO_URI=mongodb+srv://myuser:mypass123@cluster0.abc123.mongodb.net/youtube-clone?retryWrites=true&w=majority
```

### 3. لم يتم إنشاء مستخدم قاعدة البيانات
**الحل:**
1. في MongoDB Atlas، اذهب إلى **"Database Access"**
2. اضغط **"Add New Database User"**
3. أدخل اسم المستخدم وكلمة المرور
4. اختر الصلاحيات (Permissions): **"Read and write to any database"**
5. اضغط **"Add User"**

## نصائح إضافية

### للعثور على سلسلة الاتصال:
1. في MongoDB Atlas، اضغط على **"Connect"** بجانب اسم الكلاستر
2. اختر **"Connect your application"**
3. اختر **"Node.js"** كاللغة
4. انسخ السلسلة المعروضة
5. استبدل `<password>` بكلمة المرور الفعلية
6. استبدل `<dbname>` باسم قاعدة البيانات

### للتحقق من IP الحالي:
- اذهب إلى: https://whatismyipaddress.com/
- انسخ العنوان المعروض
- أضفه يدوياً في MongoDB Atlas إذا لزم الأمر

## الدعم
إذا استمرت المشكلة:
1. تأكد من اتصالك بالإنترنت
2. تحقق من إعدادات الجدار الناري (Firewall)
3. راجع ملف `.env` للتأكد من صحة البيانات
4. جرب إعادة تشغيل السيرفر

